var oData = {};initialize();// 初始化function initialize() {    oTools.ReadToLocal(function (data) {        oData = $.extend(oData, data);        qryOpenAccount(function(data) {            var str1 = '',                str2 = '',                str3 = '',                str4 = '',                i = 0,                exchange_kind = '',                succStr = '',                state = isWrongAccount(data.stock_account);            if (!state.bTime) {                $('#wraperSIN').show();                $('#wraperSIN .textSIN').html('亲，我们将在一个交易日内短信通知您开户结果。<BR>请点击<a href="javascript:;" id="jy">投资者教育专栏</a>查阅相关交易规则及风险提示。');                if(oData.CSDCOPENFLAG == '1'){                    $('#wraperSIN .textSIN').html('<p>亲，我们将在一个交易日内短信通知您开户结果。<BR>请点击<a href="javascript:;" id="jy">投资者教育专栏</a>查阅相关交易规则及风险提示。</p><span id="success">立即查看 转户秘籍</span>');					// 转户秘籍					$('#success').click(function(){						onJsOverrideUrlLoading('http://action:10061/?url=' + encodeURIComponent('http://www.yongjinbao.com.cn/mobile/zhuanhu.html'));					});                }				// 投资者教育				$('#jy').click(function(){					onJsOverrideUrlLoading('http://action:10061/?url=' + encodeURIComponent('http://www.gjzq.com.cn/main/service/education/tzzfxjydt/index.shtml'));				});            } else if(state.bAccount){                oTools.SaveToLocal({                        openStatus: '9999',                        csdcOpenFlag: '0',                        accountState: 'true' // accountState为true时为完成转户流程进入新开户的用户                    }, function() {                        $('#vediopassWraper').show();                        $('#vediopassWraper .passVedioText').html('亲，宝宝很抱歉，您的' + state.accountName + '账户尚未开立，如需开立，请点击<a href="javascript:;" id="bBtn">视频见证</a>立即申请。');						$('#bBtn').click(function(){                            onJsOverrideUrlLoading('http://action:10050?urlfalse=/sjkh/fail.htm?state=3&&urltrue=/sjkh/setpwd.htm&&cardId=' + oData.IDNUMBER + '&&mobileNo=' + oData.MOBILENO + '&&branchNo=' + branchNo + '&&clientId=' + oData.CLIENTID + '&&clientName=' + oData.CLIENTNAME);                        });                    });            } else {                if (oData.CSDCOPENFLAG == '1') {                    $('#wraperSIN').show();                    $('#wraperSIN .textSIN').html('<p>亲，我们将在一个交易日内短信通知您开户结果。<BR>请点击<a href="javascript:;" id="jy">投资者教育专栏</a>查阅相关交易规则及风险提示。</p><span id="newSuccess">立即查看 转户秘籍</span>');					// 投资者教育					$('#jy').click(function(){						onJsOverrideUrlLoading('http://action:10061/?url=' + encodeURIComponent('http://www.gjzq.com.cn/main/service/education/tzzfxjydt/index.shtml'));					});					// 转户秘籍					$('#newSuccess').click(function(){						onJsOverrideUrlLoading('http://action:10061/?url=' + encodeURIComponent('http://www.yongjinbao.com.cn/mobile/zhuanhu.html'));					});                } else {                    $('#tranWraper').show();                    $('#tranWraper .textSIN').html('亲，恭喜您成功开通账户。<BR>请点击<a href="javascript:;" id="jy">投资者教育专栏</a>查阅相关交易规则及风险提示。');                    $('#tranWraper .textAcc').eq(1).html('<span class="textAlign">资金账户：</span>' + data.fund_account.fund_account);					// 投资者教育					$('#jy').click(function(){						onJsOverrideUrlLoading('http://action:10061/?url=' + encodeURIComponent('http://www.gjzq.com.cn/main/service/education/tzzfxjydt/index.shtml'));					});                    if (!data.stock_account) { // 不存在股东账户                        return;                    }                    for (; i < data.stock_account.length; i++) {                        if (data.stock_account[i].stock_account) {                            if (data.stock_account[i].exchange_kind === '10') {                                exchange_kind = '沪A股东账户';                                str1 = '<p class="textAcc"><span class="textAlign">' + exchange_kind + '：</span>' + data.stock_account[i].stock_account + '</p>';                            } else if (data.stock_account[i].exchange_kind === '20') {                                exchange_kind = '深A股东账户';                                str2 = '<p class="textAcc"><span class="textAlign">' + exchange_kind + '：</span>' + data.stock_account[i].stock_account + '</p>';                            } else if (data.stock_account[i].exchange_kind === '11') {                                exchange_kind = '沪基金账户';                                str3 = '<p class="textAcc"><span class="textAlign">' + exchange_kind + '：</span>' + data.stock_account[i].stock_account + '</p>';                            } else if(data.stock_account[i].exchange_kind === '21'){                                exchange_kind = '深基金账户';                                str4 = '<p class="textAcc"><span class="textAlign">' + exchange_kind + '：</span>' + data.stock_account[i].stock_account + '</p>';                            }                        }                    }                                        $('#tranWraper .stock_account').html(str1 + str2 + str3 + str4);                }            }			// 查看开户协议			$('#showSign').click(function(){				onJsOverrideUrlLoading('/sjkh/showsign.htm');			});        });    }, "clientId=&clientName=&IdNumber=&MobileNo=&csdcOpenFlag=");};// 开户结果查询function qryOpenAccount(succ) {    var params = cRequestSign + encodeURI("?action=31001&path=/WA0038&op_station=($tztudid)&branch_no=" + branchNo + "&client_id=" + oData.CLIENTID);    getData(params, '', function (data){        var binData = JSON.parse(data.BINDATA),            error_no = binData.error_no,            error_info = binData.error_info;        console.log(oData);        if (error_no >= '0') {            succ(binData);        } else {            alert(error_info);        }    });};// 开户状态查询function qryOpenStatus(succ) {    var params = cRequestSign + encodeURI("?action=31001&path=/WA0037&op_station=($tztudid)&branch_no=" + branchNo + "&client_id=" + oData.CLIENTID + "&mobile_tel=" + oData.MOBILENO);    getData(params, '', function (data){        var binData = JSON.parse(data.BINDATA),            error_no = binData.error_no,            error_info = binData.error_info;        if (error_no >= '0') {            succ(binData);        } else {            alert(error_info);        }    });};// 判断客户是否选错流程分支 bBank三方存管的属性 bBankResult是失败的提示function isWrongAccount(arr1) {    var i = 0,        j = 0,        bAll = false,        resultJson = {            bAccount: false,            bTime: true, // false: 为非交易时间            bBank: false,            accountName: ''        };    if (!arr1) {        return resultJson;    }    for (; i < arr1.length; i++) {        if (arr1[i].open_status == '3') {            resultJson.bAccount = true;            if (arr1[i].exchange_kind == '10') {                resultJson.accountName += '上海A股';            } else if (arr1[i].exchange_kind == '20') {                resultJson.accountName += '或深圳A股';            }        } else if (arr1[i].open_status == '0') {            bAll = true;        } else {            bAll = false;        }    }    if (bAll) {        resultJson.bTime = false;    }    return resultJson;};